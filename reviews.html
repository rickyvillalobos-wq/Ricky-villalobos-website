<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave a Review - Ricky Villalobos | 12:45 Team</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- EmailJS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>
    <!-- Header Section -->
    <header class="reviews-header">
        <div class="container">
            <div class="header-content">
                <h1>Share Your Experience</h1>
                <p>We'd love to hear about your experience working with Ricky and the 12:45 Team. Your review helps us continuously improve our services and assists future clients in making informed decisions.</p>
                <div class="agent-info">
                    <div class="agent-details">
                        <h3>Ricky Villalobos</h3>
                        <p>12:45 Team • Keller Williams Capital Properties</p>
                        <p><i class="fas fa-phone"></i> (571) 454-3438</p>
                        <p><i class="fas fa-envelope"></i> rickyvillalobos@kw.com</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Review Form Section -->
    <section class="leave-review">
        <div class="container">
            <div class="review-form-container">
                <form class="review-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="review-name">Your Name *</label>
                            <input type="text" id="review-name" placeholder="Enter your full name" required>
                        </div>
                        <div class="form-group">
                            <label for="review-email">Email Address</label>
                            <input type="email" id="review-email" placeholder="your.email@example.com">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="review-service">Service Used</label>
                            <select id="review-service">
                                <option value="">Select the service you used</option>
                                <option value="buying">Home Buying</option>
                                <option value="selling">Home Selling</option>
                                <option value="renting">Rental Services</option>
                                <option value="staging">Home Staging</option>
                                <option value="junk-removal">Junk Removal</option>
                                <option value="property-management">Property Management</option>
                                <option value="contracting">Contracting Services</option>
                                <option value="lawn-care">Lawn Care</option>
                                <option value="consultation">Consultation</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="review-rating">Overall Rating *</label>
                            <div class="star-rating" id="star-rating">
                                <span class="star" data-rating="1">★</span>
                                <span class="star" data-rating="2">★</span>
                                <span class="star" data-rating="3">★</span>
                                <span class="star" data-rating="4">★</span>
                                <span class="star" data-rating="5">★</span>
                            </div>
                            <input type="hidden" id="review-rating" name="rating" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="review-title">Review Title *</label>
                            <input type="text" id="review-title" placeholder="Brief title for your review" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="review-content">Your Review *</label>
                            <textarea id="review-content" rows="6" placeholder="Share your experience working with Ricky and the 12:45 Team..." required></textarea>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <div class="consent-group">
                                <input type="checkbox" id="review-consent" required>
                                <label for="review-consent">I consent to having this review displayed on the website and marketing materials. I understand that my name and review content may be publicly visible.</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <button type="submit" class="btn btn-primary review-submit" onclick="handleReviewSubmit(event)">Submit Review</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Success Message Section -->
    <section class="thank-you" id="thank-you-section" style="display: none;">
        <div class="container">
            <div class="thank-you-content">
                <i class="fas fa-check-circle"></i>
                <h2>Thank You!</h2>
                <p>Your review has been submitted successfully. We appreciate your feedback and will review it shortly.</p>
                <div class="contact-info">
                    <p><strong>Need immediate assistance?</strong></p>
                    <p><i class="fas fa-phone"></i> (571) 454-3438</p>
                    <p><i class="fas fa-envelope"></i> rickyvillalobos@kw.com</p>
                </div>
            </div>
        </div>
    </section>

    <!-- JavaScript -->
    <script>
    // Initialize EmailJS
    (function() {
        emailjs.init("bGxN2QNCvDgD7b7Tp");
        console.log('EmailJS initialized for reviews page');
    })();

    // Star Rating Functionality
    let currentRating = 0;
    
    document.addEventListener('DOMContentLoaded', function() {
        const stars = document.querySelectorAll('.star');
        
        stars.forEach(star => {
            star.addEventListener('click', function() {
                currentRating = parseInt(this.getAttribute('data-rating'));
                document.getElementById('review-rating').value = currentRating;
                highlightStars(currentRating);
            });
            
            star.addEventListener('mouseover', function() {
                const rating = parseInt(this.getAttribute('data-rating'));
                highlightStars(rating);
            });
        });
        
        document.querySelector('.star-rating').addEventListener('mouseleave', function() {
            highlightStars(currentRating);
        });
    });
    
    function highlightStars(rating) {
        const stars = document.querySelectorAll('.star');
        stars.forEach((star, index) => {
            if (index < rating) {
                star.classList.add('active');
            } else {
                star.classList.remove('active');
            }
        });
    }

    // Review Form Submission
    function handleReviewSubmit(event) {
        event.preventDefault();
        event.stopPropagation();
        console.log('Review form submitted!');
        
        // Get form data
        const formData = {
            name: document.getElementById('review-name')?.value || '',
            email: document.getElementById('review-email')?.value || '',
            service: document.getElementById('review-service')?.value || '',
            rating: currentRating,
            title: document.getElementById('review-title')?.value || '',
            content: document.getElementById('review-content')?.value || '',
            consent: document.getElementById('review-consent')?.checked || false
        };
        
        // Validate required fields
        if (!formData.name || !formData.rating || !formData.title || !formData.content || !formData.consent) {
            alert('Please fill in all required fields (Name, Rating, Title, Content) and provide consent for review display.');
            return;
        }
        
        // Show loading state
        const submitBtn = event.target;
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Submitting...';
        submitBtn.disabled = true;
        
        // Send email via EmailJS
        const templateParams = {
            to_email: 'rickyvillalobos@kw.com',
            from_name: formData.name,
            from_email: formData.email,
            phone: '', // Reviews don't have phone
            message: `New Client Review Submission:

Name: ${formData.name}
Email: ${formData.email}
Service Used: ${formData.service}
Rating: ${formData.rating}/5 stars
Review Title: ${formData.title}

Review Content:
${formData.content}

Consent for Display: ${formData.consent ? 'Yes' : 'No'}

Submitted: ${new Date().toLocaleString()}

Source: Standalone Reviews Page`,
            subject: `Website Review Submission - ${formData.name}`,
            timestamp: new Date().toLocaleString()
        };
        
        console.log('Sending review email with params:', templateParams);
        
        emailjs.send('service_ll15f7k', 'template_cz2jmqw', templateParams)
            .then(function(response) {
                console.log('Review email sent successfully!', response);
                
                // Hide form and show thank you message
                document.querySelector('.leave-review').style.display = 'none';
                document.getElementById('thank-you-section').style.display = 'block';
                
                // Scroll to thank you section
                document.getElementById('thank-you-section').scrollIntoView({ 
                    behavior: 'smooth' 
                });
            })
            .catch(function(error) {
                console.error('Failed to send review email:', error);
                alert('There was an issue submitting your review. Please try again or contact Ricky directly at (571) 454-3438.');
            })
            .finally(function() {
                // Reset button state
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            });
    }
    </script>

    <!-- Additional Styles for Reviews Page -->
    <style>
    .reviews-header {
        background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        color: white;
        padding: 4rem 0 3rem;
        text-align: center;
    }
    
    .reviews-header h1 {
        font-size: 3rem;
        margin-bottom: 1rem;
        font-weight: 700;
    }
    
    .reviews-header p {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        opacity: 0.9;
    }
    
    .agent-info {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 2rem;
        max-width: 400px;
        margin: 0 auto;
        backdrop-filter: blur(10px);
    }
    
    .agent-details h3 {
        margin-bottom: 0.5rem;
        font-size: 1.5rem;
    }
    
    .agent-details p {
        margin-bottom: 0.5rem;
        opacity: 0.9;
    }
    
    .agent-details i {
        margin-right: 0.5rem;
        width: 16px;
    }
    
    .leave-review {
        padding: 4rem 0;
        background: #f8f9fa;
    }
    
    .thank-you {
        padding: 4rem 0;
        background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        color: white;
        text-align: center;
    }
    
    .thank-you-content i {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.9;
    }
    
    .thank-you-content h2 {
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }
    
    .thank-you-content p {
        font-size: 1.2rem;
        margin-bottom: 2rem;
    }
    
    .contact-info {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 1.5rem;
        max-width: 300px;
        margin: 0 auto;
        backdrop-filter: blur(10px);
    }
    
    .contact-info p {
        margin-bottom: 0.5rem;
    }
    
    @media (max-width: 768px) {
        .reviews-header {
            padding: 3rem 0 2rem;
        }
        
        .reviews-header h1 {
            font-size: 2rem;
        }
        
        .reviews-header p {
            font-size: 1rem;
        }
        
        .agent-info {
            padding: 1.5rem;
        }
        
        .leave-review {
            padding: 3rem 0;
        }
    }
    </style>
</body>
</html>